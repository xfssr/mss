# Руководство по настройке и запуску проекта

## Проблемы, которые были исправлены

### 1. База данных
**Проблема**: Схема Prisma была настроена на PostgreSQL, но в проекте использовалась SQLite база данных.

**Решение**:
- Изменен `datasource db` в `prisma/schema.prisma` с PostgreSQL на SQLite
- Обновлен `migration_lock.toml` для указания SQLite
- Пересозданы миграции для SQLite синтаксиса

### 2. Структура данных Example
**Проблема**: Модель Example в schema.prisma не соответствовала коду приложения. В коде использовались поля `mediaType`, `mediaUrl`, `posterUrl`, но в схеме были `previewImage` и `videoUrl`.

**Решение**:
- Обновлена модель Example в schema.prisma для соответствия коду
- Создана новая миграция с правильной структурой

### 3. Функция маппинга dbSettingsToUi
**Проблема**: Функция `dbSettingsToUi` возвращала сырые данные из БД вместо преобразования в правильный формат UI.

**Решение**:
- Исправлена функция для правильного преобразования полей `heroTitleHe/En`, `heroSubtitleHe/En` и т.д. в объекты L10n

### 4. Файл окружения
**Проблема**: Отсутствовал файл `.env` с переменными окружения.

**Решение**:
- Создан `.env` с правильной конфигурацией DATABASE_URL
- Создан `.env.example` для документации

### 5. Скрипты npm
**Проблема**: Отсутствовали скрипты для разработки и запуска приложения.

**Решение**:
- Добавлены скрипты `dev` и `start` в package.json

## Установка и запуск

### Первый запуск

1. Скопируйте `.env.example` в `.env`:
```bash
cp .env.example .env
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте и заполните базу данных:
```bash
npx prisma migrate dev
```

База данных автоматически заполнится начальными данными из `prisma/seed.ts`.

### Разработка

Запустите dev сервер:
```bash
npm run dev
```

Приложение будет доступно по адресу http://localhost:3000

### Production

Соберите проект:
```bash
npm run build
```

Запустите production сервер:
```bash
npm start
```

## Структура базы данных

База данных SQLite находится в `prisma/dev.db`.

Основные таблицы:
- `SiteSettings` - настройки сайта (заголовки, тексты)
- `PricingConfig` - конфигурация цен
- `HeroMedia` - изображения для героя главной страницы
- `PriceItem` - элементы прайс-листа
- `Catalog` - каталоги услуг
- `Example` - примеры работ для каждого каталога

## Переменные окружения

- `DATABASE_URL` - путь к базе данных SQLite (по умолчанию: `file:./dev.db`)
- `NEXT_PUBLIC_SITE_URL` - URL сайта для метаданных
- `ADMIN_PASSWORD` - пароль для админ-панели (опционально)

## Миграции

Создать новую миграцию:
```bash
npx prisma migrate dev --name описание_изменений
```

Применить миграции:
```bash
npx prisma migrate deploy
```

Сбросить базу данных:
```bash
npx prisma migrate reset
```

## Заполнение данными

Данные для заполнения находятся в `prisma/seed.ts`.

Запустить seed вручную:
```bash
npx prisma db seed
```
